# ==========================================
# MuMuAINovel 配置文件示例
# ==========================================
# 复制此文件为 .env 并修改配置值
# cp .env.example .env

# ==========================================
# 应用配置
# ==========================================
APP_NAME=MuMuAINovel
APP_VERSION=1.1.3
APP_HOST=0.0.0.0
APP_PORT=8000
DEBUG=false
TZ=Asia/Shanghai

# ==========================================
# PostgreSQL 数据库配置
# ==========================================

# PostgreSQL 连接信息
POSTGRES_DB=mumuai_novel
POSTGRES_USER=mumuai
POSTGRES_PASSWORD=123456
POSTGRES_PORT=5432

# 数据库连接 URL（Docker 部署时自动生成）
DATABASE_URL=postgresql+asyncpg://mumuai:123456@localhost:5432/mumuai_novel

# PostgreSQL 连接池配置（优化后，支持80-150并发用户）
DATABASE_POOL_SIZE=30  # 核心连接数（默认30，小团队可用20）
DATABASE_MAX_OVERFLOW=20  # 最大溢出连接数（默认20，小团队可用10）
DATABASE_POOL_TIMEOUT=60  # 连接等待超时秒数（默认60）
DATABASE_POOL_RECYCLE=1800  # 连接回收时间秒数（默认1800=30分钟）
DATABASE_POOL_PRE_PING=True  # 连接前检测是否有效
DATABASE_POOL_USE_LIFO=True  # 使用LIFO策略提高连接复用率

# 会话监控配置
DATABASE_SESSION_MAX_ACTIVE=50  # 活跃会话警告阈值
DATABASE_SESSION_LEAK_THRESHOLD=100  # 会话泄漏严重告警阈值

# 数据库监控配置
DATABASE_ENABLE_SLOW_QUERY_LOG=True  # 启用慢查询日志
DATABASE_SLOW_QUERY_THRESHOLD=1.0  # 慢查询阈值（秒）
DATABASE_ENABLE_METRICS=True  # 启用性能指标收集

# ==========================================
# 代理配置（可选）
# ==========================================
# HTTP_PROXY=http://your-proxy:port
# HTTPS_PROXY=http://your-proxy:port
# NO_PROXY=localhost,127.0.0.1

# ==========================================
# 日志配置
# ==========================================
LOG_LEVEL=INFO
LOG_TO_FILE=true
LOG_FILE_PATH=logs/app.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=30

# ==========================================
# CORS 配置
# ==========================================
CORS_ORIGINS=["http://localhost:8000","http://127.0.0.1:8000"]

# ==========================================
# AI 服务配置（至少配置一个）
# ==========================================

# OpenAI 配置
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1

# 默认 AI 配置
DEFAULT_AI_PROVIDER=openai
DEFAULT_MODEL=gpt-4o-mini
DEFAULT_TEMPERATURE=0.7
DEFAULT_MAX_TOKENS=32000

# ==========================================
# LinuxDO OAuth 配置（可选）
# ==========================================
# LINUXDO_CLIENT_ID=your_client_id_here
# LINUXDO_CLIENT_SECRET=your_client_secret_here
# LINUXDO_REDIRECT_URI=http://localhost:8000/api/auth/callback

# 前端 URL（OAuth 回调后重定向）
FRONTEND_URL=http://localhost:8000

# 初始管理员（LinuxDO user_id）
# INITIAL_ADMIN_LINUXDO_ID=your_linuxdo_user_id

# ==========================================
# 本地账户登录配置
# ==========================================
LOCAL_AUTH_ENABLED=true
LOCAL_AUTH_USERNAME=admin
LOCAL_AUTH_PASSWORD=admin123
LOCAL_AUTH_DISPLAY_NAME=本地管理员

# ==========================================
# 会话配置
# ==========================================
SESSION_EXPIRE_MINUTES=120
SESSION_REFRESH_THRESHOLD_MINUTES=30
